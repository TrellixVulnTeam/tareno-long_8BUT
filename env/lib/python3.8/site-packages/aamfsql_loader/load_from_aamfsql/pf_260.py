from sray_db.apps import apps
from aamfsql_loader.load_from_aamfsql.util import query_to_interface

import pandas as pd

def upload(start_date, end_date):

    app = apps['PreferencesFilter'][(2, 6, 0, 0)]

    q = f"""
    SELECT assetid,
        date,
        ade,
        alc,
        cou,
        def,
        fos,
        gam,
        gmo,
        nuc,
        por,
        ste,
        tob,
        wea
    FROM ResDaBa.dbo.f_sray_flags
    WHERE job_id = 77991
        AND date BETWEEN '{start_date}' AND '{end_date}'
    """

    query_to_interface(q, app)
