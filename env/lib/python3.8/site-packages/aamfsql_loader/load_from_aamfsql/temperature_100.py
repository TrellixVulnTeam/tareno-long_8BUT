import logging

import pandas as pd

from aamfsql_loader.load_from_aamfsql.util import query_to_interface
from sray_db.apps import apps

log = logging.getLogger(__name__)


def upload(start_date, end_date):

    app = apps['temperature'][(1, 0, 0, 0)]

    q = f"""
    SELECT assetid, 
        date,
        score_near,
        score_far,
        trend,
        target,
        scope3,
        eir,
        iea_sector
    FROM ResDaBa.dbo.f_sray_temperature
    WHERE job_id = 322437
    """

    log.info(f'{pd.Timestamp.now()}: Starting upload for {app.name} for full history')
    query_to_interface(q, app)

    app = apps['temperature_emissions'][(1, 0, 0, 0)]

    q = f"""
    SELECT assetid, 
        date,
        em,
        em_1,
        em_2,
        em_3,
        source,
        rep_ref_em AS em_date
    FROM ResDaBa.dbo.f_sray_temperature
    WHERE job_id = 322437
    """

    log.info(f'{pd.Timestamp.now()}: Starting upload for {app.name} for full history')
    query_to_interface(q, app)

    app = apps['temperature_financials'][(1, 0, 0, 0)]

    q = f"""
    SELECT assetid, 
        date,
        va_usd,
        rep_ref_va AS va_date
    FROM ResDaBa.dbo.f_sray_temperature
    WHERE job_id = 322437
    """

    log.info(f'{pd.Timestamp.now()}: Starting upload for {app.name} for full history')
    query_to_interface(q, app)
