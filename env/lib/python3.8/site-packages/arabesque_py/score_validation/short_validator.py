from typing import List

from arabesque_py.prometheus.prometheus import Prometheus
from arabesque_py.score_validation.validator import Validator


class ShortValidator(Validator):
    min_val: float
    max_val: float
    threshold_count: int
    feature_cols: List[str]

    def __init__(
        self,
        app_name: str,
        prometheus: Prometheus,
        features: List[str],
        min_val: float = -1.3,
        max_val: float = 0.7,
        threshold_count: int = 15,
    ) -> None:
        super().__init__(app_name, prometheus)

        self.min_val = min_val
        self.max_val = max_val
        self.threshold_count = threshold_count
        self.feature_cols = self.get_feature_col_names(features)

    def get_feature_col_names(self, features: List[str]) -> List[str]:
        """
        Returns the news values for each feature. It does this for the nv_<feature>
        news values and not nnv or pnv

        Args:
            features (List[str]): List of features

        Returns:
            List[str]: List of nv_<feature>
        """
        return [f"nv_{feature}" for feature in features]
