from falcon import Request
from flask_restful import Resource

from arabesque_py.api.flask.response.response import Response

ready = False


class ReadyCheckResource(Resource):
    """
    This resource is just used for internal readiness checking to see if the
    service is ready to serve requests
    """

    require_authentication = False

    def get(self):
        """
        This internal resource handles checking if the service is ready to serve
        requests
        ---
        description: Readiness check returning a 200 response
        summary: Readiness check
        tags:
        - Test
        responses:
            200:
                description: Readiness check returning a 200 response
                content:
                    application/json:
                        schema:
                            type: object
                            additionalProperties:
                                type: string
            503:
                description: Ready check failed
                content:
                    application/json:
                        schema:
                            type: object
                            additionalProperties:
                                type: string
        """

        response = Response()
        if ready:
            response.respond()
            return

        response.respond_503()
