import falcon
from falcon import Request, Response


class RequireJSONMiddleware:
    def process_request(self, request: Request, response: Response):
        """
        Args:
            request: The request
            response: The response
        """
        if not request.client_accepts_json:
            raise falcon.HTTPNotAcceptable(
                "This API only supports responses encoded as JSON.",
                href="http://docs.examples.com/api/json",
            )

        if request.method in ("POST", "PUT"):
            if "application/json" not in request.content_type:
                raise falcon.HTTPUnsupportedMediaType(
                    "This API only supports requests encoded as JSON.",
                    href="http://docs.examples.com/api/json",
                )
