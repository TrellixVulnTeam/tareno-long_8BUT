import datetime

from arabesque_py.proto.helpers.timestamp import (
    get_protobuf_timestamp_from_date,
    proto_timestamp_to_dt,
)


def test_get_protobuf_timestamp_from_date():
    date = datetime.date(2020, 1, 1)

    assert 1577836800 == get_protobuf_timestamp_from_date(date).seconds


def test_proto_to_dt():
    date = datetime.date(2020, 1, 1)
    proto_ts = get_protobuf_timestamp_from_date(date)

    assert proto_timestamp_to_dt(proto_ts) == datetime.datetime.combine(
        date, datetime.datetime.min.time()
    )
